<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j" template="/layout/template.xhtml">

	<style>
.activeRow {
	color: red;
	background-color: red;
}
</style>

	<ui:define name="body">

		<a4j:form ajaxSubmit="true">

		<ui:include src="/xhtml/consumer/consumerPanel.xhtml"/>
		
		<h:panelGrid id="queryListAll">
			
				<rich:dataTable value="#{queryLog.queries}" var="savedQuery">

					<f:facet name="header">
						<rich:columnGroup>
							<h:column>
								<h:outputText styleClass="headerText" value="Query" />
							</h:column>
							<h:column>
								<h:outputText styleClass="headerText" value="Comments" />
							</h:column>
							<h:column>
								<h:outputText styleClass="headerText" value="Database" />
							</h:column>
							<h:column>
								<h:outputText styleClass="headerText" value="Results" />
							</h:column>
							<h:column>
								<h:outputText styleClass="headerText" value="Download" />
							</h:column>

						</rich:columnGroup>
					</f:facet>

					<rich:subTable value="#{savedQuery.responses}" var="response"
						rowKeyVar="rowKey">

						<rich:column rowspan="#{savedQuery.responses.size()}"
							rendered="#{rowKey eq 0}">

							<h:panelGrid numcols="2">
								<h:panelGrid numcols="1">

									<a4j:commandButton value="Edit"
										action="#{query.edit(savedQuery.id)}" styleClass="roundButton" />
									<a4j:commandButton value="Clone"
										action="#{query.clone(savedQuery.id)}"
										styleClass="roundButton" />
									<a4j:commandButton value="Delete"
										action="#{queryLog.deleteQuery(savedQuery.id)}"
										styleClass="roundButton" reRender="queryListAll" />

								</h:panelGrid>
								<h:outputText value="#{savedQuery.queryString}" />
							</h:panelGrid>
						</rich:column>

						<rich:column rowspan="#{savedQuery.responses.size()}" rendered="#{rowKey eq 0}">
							<h:outputText value="#{savedQuery.comments}" />
						</rich:column>

						<rich:column>
							<h:selectBooleanCheckbox value="#{consumers.queries[response.fullQueryURL]}" />
							<h:outputText
								value="#{registryFacade.getResourceTitle(response.node)}" />

						</rich:column>

						<rich:column>
							<h:outputText value="#{response.stats}" />
						</rich:column>

						<rich:column>
							<h:outputLink value="#{response.fullQueryURL}">
								<h:outputText value="XSAMS" />
							</h:outputLink>
						</rich:column>
					</rich:subTable>

				</rich:dataTable>
			
		</h:panelGrid>
		</a4j:form>
	</ui:define>

</ui:composition>
